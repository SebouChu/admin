<% content_for :title, @school %>

<div class="row">

  <div class="col-md-4">
    <div class="card flex-fill w-100">
      <div class="card-header">
        <h2 class="card-title mb-0 h5"><%= t('metadata') %></h2>
      </div>
      <div class="card-body">
        <h3 class="h5"><%= Education::School.human_attribute_name('address') %></h3>
        <p>
          <%= @school.address %><br>
          <%= @school.zipcode %> <%= @school.city %><br>
          <%= @school.country %>
        </p>
        <h3 class="h5"><%= Education::School.human_attribute_name('phone') %></h3>
        <p><%= @school.phone %></p>
      </div>
    </div>
  </div>

  <% if @school.programs.any? %>
    <div class="col-md-4">
      <div class="card flex-fill w-100">
        <div class="card-header">
          <h2 class="card-title mb-0 h5"><%= Education::School.human_attribute_name('programs') %></h2>
        </div>
        <div class="card-body">
          <ul class="list-unstyled">
            <% @school.programs.ordered.each do |program| %>
              <li><%= link_to_if can?(:read, program), program, [:admin, program] %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  <% end %>

  <% if @school.websites.any? %>
    <div class="col-md-4">
      <div class="card flex-fill w-100">
        <div class="card-header">
          <h2 class="card-title mb-0 h5"><%= Education::School.human_attribute_name('websites') %></h2>
        </div>
        <div class="card-body">
          <ul class="list-unstyled">
            <% @school.websites.each do |website| %>
              <li><%= link_to website, [:admin, website] %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  <% end %>

</div>

<div class="card flex-fill w-100">
  <div class="card-header">
    <div class="float-end">
      <%= link_to "Gérer les rôles",
                  admin_education_school_roles_path(school_id: @school.id),
                  class: button_classes if can?(:update, University::Role) %>
    </div>
    <h2 class="card-title mb-0 h5">Rôles</h2>
  </div>
  <div class="card-body">
    <% if @roles.any? %>
      <table class="table">
        <thead>
          <tr>
            <th class="ps-0"><%= University::Role.model_name.human %></th>
            <th><%= University::Role.human_attribute_name('people') %></th>
          </tr>
        </thead>
        <tbody>
          <% @roles.each do |role| %>
            <tr>
              <td class="ps-0">
                <%= link_to_if  can?(:read, role),
                                role,
                                admin_education_school_role_path(role, { school_id: @school.id }) %>
              </td>
              <td><%= role.involvements.includes(:person).ordered.map { |involvement| involvement.person.to_s }.to_sentence %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% end %>
  </div>
</div>

<% content_for :action_bar_right do %>
  <%= edit_link @school %>
<% end %>
